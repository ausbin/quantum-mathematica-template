(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24822,        748]
NotebookOptionsPosition[     22194,        694]
NotebookOutlinePosition[     22594,        710]
CellTagsIndexPosition[     22551,        707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Quantum Mathematica Template", "Section",
 CellChangeTimes->{{3.8509951267974873`*^9, 
  3.850995135360435*^9}},ExpressionUUID->"76a87d1f-b994-45af-956c-\
61a14ff0fcd8"],

Cell[CellGroupData[{

Cell["Basic objects", "Subsection",
 CellChangeTimes->{{3.850651470635248*^9, 
  3.850651476307333*^9}},ExpressionUUID->"739d32eb-2d5c-47d7-a258-\
65fe440418e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   TemplateBox[{"0"},
    "Bra"], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"1"},
    "Bra"], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"plus"},
    "Bra"], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}], "}"}], "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"minus"},
    "Bra"], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], "}"}], "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"0"},
    "Ket"], " ", "=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    TemplateBox[{"0"},
     "Bra"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"1"},
    "Ket"], " ", "=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    TemplateBox[{"1"},
     "Bra"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"plus"},
    "Ket"], "=", 
   RowBox[{"ConjugateTranspose", "[", 
    TemplateBox[{"plus"},
     "Bra"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"minus"},
    "Ket"], "=", 
   RowBox[{"ConjugateTranspose", "[", 
    TemplateBox[{"minus"},
     "Bra"], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.85065450621387*^9, 3.850654527817834*^9}, {
  3.850654573074264*^9, 3.8506546324109163`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1c576237-332a-4333-a871-e8c775877af4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common gates", "Subsection",
 CellChangeTimes->{{3.8506514993642406`*^9, 
  3.850651504661201*^9}},ExpressionUUID->"9a2c32b3-f865-4a5c-b493-\
cfaf955c7aca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}], "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rx", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"PauliMatrix", "[", "1", "]"}], " ", 
     RowBox[{"\[Phi]", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ry", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"PauliMatrix", "[", "2", "]"}], " ", 
     RowBox[{"\[Phi]", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rz", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"PauliMatrix", "[", "3", "]"}], " ", 
     RowBox[{"\[Phi]", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phase", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", "*", "\[Theta]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.850651513330409*^9, 3.8506515371250668`*^9}, {
   3.850653899869413*^9, 3.850653983871706*^9}, {3.8506543140096493`*^9, 
   3.8506543333081837`*^9}, {3.8506544467450867`*^9, 3.85065444803412*^9}, 
   3.850931749906703*^9, {3.850994954628456*^9, 3.8509949729056873`*^9}, {
   3.850995022322958*^9, 3.85099502287642*^9}, {3.851029106681731*^9, 
   3.851029109758119*^9}},ExpressionUUID->"da06b215-9811-4a6a-a34e-\
2038005c24c7"],

Cell[CellGroupData[{

Cell["Controlled-on-one gates", "Subsubsection",
 CellChangeTimes->{{3.8510232728111553`*^9, 3.851023298818987*^9}, {
  3.851023400260501*^9, 
  3.851023402799225*^9}},ExpressionUUID->"aa246c85-f3e5-47af-b7e1-\
9d5f035006fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LeftCtrl", "[", "gate_", "]"}], ":=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], ".", 
       TemplateBox[{"0"},
        "Bra"]}], ",", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], " ", "+", " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], ".", 
       TemplateBox[{"1"},
        "Bra"]}], ",", "gate"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightCtrl", "[", "gate_", "]"}], ":=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], ".", 
       TemplateBox[{"0"},
        "Bra"]}]}], "]"}], " ", "+", " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"gate", ",", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], ".", 
       TemplateBox[{"1"},
        "Bra"]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CNOT", " ", "=", 
   RowBox[{"LeftCtrl", "[", "X", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCNOT", " ", "=", " ", 
   RowBox[{"LeftCtrl", "[", "CNOT", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCCNOT", " ", "=", " ", 
   RowBox[{"LeftCtrl", "[", "CCNOT", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CPhase", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"LeftCtrl", "[", 
    RowBox[{"Phase", "[", "\[Theta]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCPhase", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"LeftCtrl", "[", 
    RowBox[{"CPhase", "[", "\[Theta]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCCPhase", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"LeftCtrl", "[", 
    RowBox[{"CCPhase", "[", "\[Theta]", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.851023404752508*^9, 3.8510234581070337`*^9}, {
   3.851023530015458*^9, 3.8510235441588593`*^9}, {3.8510236758143053`*^9, 
   3.851023687291263*^9}, {3.85102372492159*^9, 3.851023740557358*^9}, {
   3.85102377898771*^9, 3.851023779260981*^9}, 
   3.85102923100871*^9},ExpressionUUID->"243ca72d-435a-440a-94ca-\
762a224b3fa7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-on-zero gates", "Subsubsection",
 CellChangeTimes->{{3.8509360208611183`*^9, 
  3.8509360296858177`*^9}},ExpressionUUID->"97be8260-61e7-423b-8634-\
5e4df6deef25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Left0Ctrl", "[", "gate_", "]"}], ":=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], ".", 
       TemplateBox[{"0"},
        "Bra"]}], ",", "gate"}], "]"}], "+", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], ".", 
       TemplateBox[{"1"},
        "Bra"]}], ",", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Right0Ctrl", "[", "gate_", "]"}], ":=", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"gate", ",", 
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], ".", 
       TemplateBox[{"0"},
        "Bra"]}]}], "]"}], "+", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], ".", 
       TemplateBox[{"1"},
        "Bra"]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"C0NOT", " ", "=", " ", 
   RowBox[{"Left0Ctrl", "[", "X", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CC0NOT", " ", "=", " ", 
   RowBox[{"Left0Ctrl", "[", "C0NOT", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCC0NOT", " ", "=", 
   RowBox[{"Left0Ctrl", "[", "CC0NOT", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C0Phase", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"Left0Ctrl", "[", 
    RowBox[{"Phase", "[", "\[Theta]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CC0Phase", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"Left0Ctrl", "[", 
    RowBox[{"C0Phase", "[", "\[Theta]", "]"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCC0Phase", "[", "\[Theta]_", "]"}], " ", ":=", 
   RowBox[{"Left0Ctrl", "[", 
    RowBox[{"CC0Phase", "[", "\[Theta]", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8510239496854677`*^9, {3.851025393717265*^9, 3.851025416717691*^9}, {
   3.85102544799269*^9, 3.8510254696572723`*^9}, 
   3.8510292177733917`*^9},ExpressionUUID->"18e7e345-8253-4e5b-ab1c-\
f280ca8aad94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mixed-control gates", "Subsubsection",
 CellChangeTimes->{{3.850936069823303*^9, 
  3.850936080870802*^9}},ExpressionUUID->"122dcafa-13b8-44b0-99ae-\
72f41e08fc7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CbNOT", "[", "b_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"b", "==", "0"}], ",", "C0NOT", ",", "CNOT"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCbNOT", "[", "b_", "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"Left0Ctrl", "[", 
      RowBox[{"CbNOT", "[", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", "b", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"LeftCtrl", "[", 
      RowBox[{"CbNOT", "[", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", "b", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCCbNOT", "[", "b_", "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "3"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"Left0Ctrl", "[", 
      RowBox[{"CCbNOT", "[", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"PadLeft", "[", 
          RowBox[{
           RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "3"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", ",", 
     RowBox[{"LeftCtrl", "[", 
      RowBox[{"CCbNOT", "[", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"PadLeft", "[", 
          RowBox[{
           RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "3"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CbPhase", "[", 
    RowBox[{"b_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"b", "==", "0"}], ",", 
     RowBox[{"C0Phase", "[", "\[Theta]", "]"}], ",", 
     RowBox[{"CPhase", "[", "\[Theta]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCbPhase", "[", 
    RowBox[{"b_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "2"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"Left0Ctrl", "[", 
      RowBox[{"CbPhase", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegerDigits", "[", "b", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[Theta]"}], "]"}], "]"}], 
     ",", 
     RowBox[{"LeftCtrl", "[", 
      RowBox[{"CbPhase", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegerDigits", "[", "b", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[Theta]"}], "]"}], "]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CCCbPhase", "[", 
    RowBox[{"b_", ",", "\[Theta]_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "3"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"Left0Ctrl", "[", 
      RowBox[{"CCbPhase", "[", 
       RowBox[{
        RowBox[{"FromDigits", "[", 
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "3"}], "]"}], "[", 
          
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], ",", "\[Theta]"}], "]"}],
       "]"}], ",", 
     RowBox[{"LeftCtrl", "[", 
      RowBox[{"CCbPhase", "[", 
       RowBox[{
        RowBox[{"FromDigits", "[", 
         RowBox[{
          RowBox[{"PadLeft", "[", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", "b", "]"}], ",", "3"}], "]"}], "[", 
          
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], ",", "\[Theta]"}], "]"}],
       "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850941488981765*^9, 3.850941792318244*^9}, {
   3.850941914538104*^9, 3.850941916067721*^9}, {3.850941954085841*^9, 
   3.850942021584488*^9}, {3.8509422821237*^9, 3.850942408963216*^9}, {
   3.850942458534691*^9, 3.850942481708283*^9}, {3.850942602885125*^9, 
   3.850942605718131*^9}, {3.8509427104237556`*^9, 3.8509427343379307`*^9}, {
   3.850942801371666*^9, 3.850942805909287*^9}, {3.850942999085432*^9, 
   3.850943133340815*^9}, {3.85094318697052*^9, 3.850943214518841*^9}, 
   3.850996316796061*^9, {3.8510287017605352`*^9, 3.85102878424676*^9}, {
   3.851028814366296*^9, 3.85102887453967*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"b578360e-2ea6-4f88-b03c-5f7bcfe40ec8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ion trap gates", "Subsubsection",
 CellChangeTimes->{{3.850654426341486*^9, 
  3.8506544387544622`*^9}},ExpressionUUID->"d2493cbc-bd9a-4f31-9a29-\
71c258984c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XX", "[", "\[Alpha]_", "]"}], ":=", " ", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]", " ", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", "0", "]"}], ",", 
       RowBox[{"\[Sigma]", "[", "0", "]"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MS", "=", 
   RowBox[{"XX", "[", 
    RowBox[{"\[Pi]", "/", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"PauliMatrix", "[", "2", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rnat", "[", 
   RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"MatrixExp", "[", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{"\[Sigma]", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Theta]", "/", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"Rnat", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.850654440845087*^9, 3.850654443222086*^9}, {
  3.85065465586255*^9, 3.850654656078384*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"929eadaf-5f17-4a6a-bb7c-f50c323856e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility Functions", "Subsubsection",
 CellChangeTimes->{{3.850651553720096*^9, 
  3.8506515580876427`*^9}},ExpressionUUID->"a82e85b9-d74e-42f7-89e0-\
d1e2223e19d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"commutator", "[", 
   RowBox[{"A_", ",", "B_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"A", ".", "B"}], " ", "-", " ", 
   RowBox[{"B", ".", "A"}]}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"af9f0fff-d606-463f-89e0-e88a001dfac3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FlipBits", "[", 
    RowBox[{"num_", ",", "nbits_"}], "]"}], ":=", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"PadLeft", "[", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{"num", ",", "2"}], "]"}], ",", "nbits"}], "]"}], "]"}], ",", 
     "2"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.850651841292963*^9, 3.850651860885861*^9}, {
  3.850651933798814*^9, 3.850651936192232*^9}, {3.8506519759811707`*^9, 
  3.85065198749226*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"a92af803-d5b5-46a1-bf00-c96da353ebdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlipEndian", "[", "gate_", "]"}], ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"gate", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"FlipBits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", 
          RowBox[{"Log2", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"FlipBits", "[", 
         RowBox[{
          RowBox[{"j", "-", "1"}], ",", 
          RowBox[{"Log2", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "+", "1"}]}], 
      "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{
       RowBox[{"Dimensions", "[", "gate", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850651583134408*^9, 3.850651608307407*^9}, {
  3.8506537700314293`*^9, 3.850653788506625*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"c1e3db0a-cc18-4877-a434-6109f91543ee"],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 5},ExpressionUUID->"48ea985a-3e15-42f1-9d21-140b0f574d76"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Your Code", "Section",
 CellChangeTimes->{{3.850995155367401*^9, 
  3.850995159364253*^9}},ExpressionUUID->"2cf14f6f-ef34-4999-8f8c-\
69aafda67faf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT", ".", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"H", ",", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], ".", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], ",", 
     TemplateBox[{"0"},
      "Ket"]}], "]"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.85065544050895*^9, 3.850655444851585*^9}, {
  3.850995178930869*^9, 3.850995244781539*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"93441d2d-038b-4eaf-b20d-1876ce2064e4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0"},
     {"0"},
     {
      FractionBox["1", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.850995202247183*^9, 3.850995245044154*^9}},
 CellLabel->
  "Out[46]//MatrixForm=",ExpressionUUID->"1035437e-e8ab-48fb-afba-\
5fc65a63119e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{633.75, 644.25},
WindowMargins->{{Automatic, 324}, {48, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"eb9230a1-64f2-4f41-b257-1c230d912b60"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 175, 3, 68, "Section",ExpressionUUID->"76a87d1f-b994-45af-956c-61a14ff0fcd8"],
Cell[CellGroupData[{
Cell[780, 29, 161, 3, 54, "Subsection",ExpressionUUID->"739d32eb-2d5c-47d7-a258-65fe440418e7"],
Cell[944, 34, 1805, 64, 196, "Input",ExpressionUUID->"1c576237-332a-4333-a871-e8c775877af4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2786, 103, 162, 3, 54, "Subsection",ExpressionUUID->"9a2c32b3-f865-4a5c-b493-cfaf955c7aca"],
Cell[2951, 108, 2276, 63, 174, "Input",ExpressionUUID->"da06b215-9811-4a6a-a34e-2038005c24c7"],
Cell[CellGroupData[{
Cell[5252, 175, 225, 4, 45, "Subsubsection",ExpressionUUID->"aa246c85-f3e5-47af-b7e1-9d5f035006fe"],
Cell[5480, 181, 2589, 76, 290, "Input",ExpressionUUID->"243ca72d-435a-440a-94ca-762a224b3fa7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8106, 262, 179, 3, 45, "Subsubsection",ExpressionUUID->"97be8260-61e7-423b-8634-5e4df6deef25"],
Cell[8288, 267, 2474, 77, 272, "Input",ExpressionUUID->"18e7e345-8253-4e5b-ab1c-f280ca8aad94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10799, 349, 170, 3, 45, "Subsubsection",ExpressionUUID->"122dcafa-13b8-44b0-99ae-72f41e08fc7a"],
Cell[10972, 354, 5188, 146, 401, "Input",ExpressionUUID->"b578360e-2ea6-4f88-b03c-5f7bcfe40ec8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16197, 505, 167, 3, 45, "Subsubsection",ExpressionUUID->"d2493cbc-bd9a-4f31-9a29-71c258984c1b"],
Cell[16367, 510, 1469, 39, 113, "Input",ExpressionUUID->"929eadaf-5f17-4a6a-bb7c-f50c323856e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17873, 554, 170, 3, 45, "Subsubsection",ExpressionUUID->"a82e85b9-d74e-42f7-89e0-d1e2223e19d3"],
Cell[18046, 559, 283, 7, 29, "Input",ExpressionUUID->"af9f0fff-d606-463f-89e0-e88a001dfac3"],
Cell[18332, 568, 635, 16, 51, "Input",ExpressionUUID->"a92af803-d5b5-46a1-bf00-c96da353ebdc"],
Cell[18970, 586, 1341, 37, 92, "Input",ExpressionUUID->"c1e3db0a-cc18-4877-a434-6109f91543ee"],
Cell[20314, 625, 329, 10, 10, "Text",ExpressionUUID->"48ea985a-3e15-42f1-9d21-140b0f574d76"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20704, 642, 154, 3, 68, "Section",ExpressionUUID->"2cf14f6f-ef34-4999-8f8c-69aafda67faf"],
Cell[CellGroupData[{
Cell[20883, 649, 538, 14, 53, "Input",ExpressionUUID->"93441d2d-038b-4eaf-b20d-1876ce2064e4"],
Cell[21424, 665, 742, 25, 114, "Output",ExpressionUUID->"1035437e-e8ab-48fb-afba-5fc65a63119e"]
}, Open  ]]
}, Open  ]]
}
]
*)

